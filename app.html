<!DOCTYPE html>
<html {{ HTML_ATTRS }}>
  <head {{ HEAD_ATTRS }}>
    {{ HEAD }}
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="apple-mobile-web-app-title" content="News Turk" />
    <meta name="msapplication-TileImage" content="/icons/144.png" />
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="theme-color" content="#FFFFFF" />
    <link rel="manifest" href="/manifest.json" />
    <link rel="apple-touch-icon" href="/icons/144.png" />
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0211958192707263"
      crossorigin="anonymous"
    ></script>
    <script src="https://www.gstatic.com/firebasejs/4.6.2/firebase.js"></script>
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", function () {
          navigator.serviceWorker
            .register("/service-worker.js")
            .then(
              function (registration) {
                if (window.matchMedia("(display-mode: standalone)").matches) {
                  const firebaseConfig = {
                    apiKey: "AIzaSyBU-DJ7AXrlISgvVHi3yjaj-utNDI7sROg",
                    authDomain: "nt-flutter-notification.firebaseapp.com",
                    projectId: "nt-flutter-notification",
                    storageBucket: "nt-flutter-notification.appspot.com",
                    messagingSenderId: "222470304912",
                    appId: "1:222470304912:web:2802fb8a5ef5b34e8a9415",
                  };
                  firebase.initializeApp(firebaseConfig);
                  var messaging = firebase.messaging();
                  messaging.getToken().then(function (token) {
                    console.log("TOKEN:" + token);
                    const formData = new FormData();
                    formData.append("token", token);
                    (async () => {
                      const rawResponse = await fetch(
                        "https://www.newsturk.com.tr/gcm-notification/add-token.php?basic_token=YWhtdGtwbG45NkBnbWFpbC5jb206MjI1NTg4KipLYXBsYW4",
                        {
                          method: "POST",
                          body: formData,
                        }
                      );
                      const content = await rawResponse.json();
                      console.log("RES: " + content);
                    })();
                  });
                }
              },
              function (err) {
                console.log("ServiceWorker registration failed: ", err);
              }
            )
            .catch(function (err) {
              console.log(err);
            });
        });
      } else {
        console.log("service worker is not supported");
      }
    </script>
  </head>
  <body {{ BODY_ATTRS }}>
    {{ APP }}
  </body>
</html>